---
- hosts: all
  become: yes
  tasks:
    - name: Collect all host IP addresses
      set_fact:
        all_host_ips: "{{ all_host_ips | default([]) + [ansible_host] }}"

    - name: Print all collected IP addresses
      debug:
        msg: "All host IPs: {{ all_host_ips }}"

- hosts: mysql_master
  become: yes
  tasks:
    - include_role:
        name: mysql
      vars:
        is_master: true

- hosts: mysql_slaves
  become: yes
  tasks:
    - include_role:
        name: mysql
      vars:
        is_slave: true

