---
 - name: Import Secret Vars
   include_vars: "{{ item }}"
   with_items:
    - "secret.yml"

 - name: Download Filebeat Package
   uri:
    url: "{{ package_url }}"
    dest: "{{ tempdir }}"
    creates: "{{ tempdir }}/{{ name }}"

 - name: Uninstall Filebeat
   yum: 
    name: "filebeat"
    state: absent

 - name: Install Filebeat
   yum: 
    name: "{{ tempdir }}/{{ name }}"
    state: present

 - name: Copy Templates
   template:
    dest: "/etc/filebeat/filebeat.yml"
    src: "filebeat.yml.j2"

 - name: Set Filebet Auto Start
   service:
    name: "filebeat"
    state: "restarted"
    enabled: yes
...
